<!DOCTYPE html>
<html xmlns:th="http://www.thymleaf.org" lang="es">

<div th:fragment="purchasing-process">
    <div class="container mx-auto py-6 bg-white shadow-lg rounded-lg p-8">
        <h2 class="text-4xl font-bold text-gray-800 mb-8">Tu Carrito</h2>

        <!-- Productos del carrito -->
        <div id="cart-items" class="space-y-6 mb-6">
            <!-- Aquí se mostrarán los productos -->
        </div>
    
        <!-- Precio total -->
        <div class="flex justify-between bg-gray-100 p-4 rounded-lg shadow-md">
            <h3 class="text-2xl font-semibold text-gray-700">Total:</h3>
            <h3 id="total-price" class="text-3xl font-bold text-[#314852]">S/. 0.00</h3>
        </div>
    
        <!-- Botón de finalizar compra -->
        <div class="text-right mt-6">
            <button class="bg-gradient-to-r from-[#314852] to-[#1f2f38] hover:from-[#1f2f38] hover:to-[#16252e] text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105" onclick="checkout()">
                Finalizar Compra
            </button>
        </div>
    </div>

    <script>
        function checkout() {
            alert('Compra finalizada. ¡Gracias por tu compra!');
            localStorage.removeItem('cart');
            window.location.href = 'confiteria.html';
        }
    
        function loadCart() {
            const cartData = JSON.parse(localStorage.getItem('cart'));
            const cartItemsContainer = document.getElementById('cart-items');
            let total = 0;

            if (cartData && Object.keys(cartData).length > 0) {
                Object.keys(cartData).forEach(productId => {
                    const quantity = cartData[productId];
                    const priceMap = {
                        mega_combo_diario: 13.90,
                        mega_combo_unico: 17.90,
                        cocacola: 4.90,
                        canchita: 9.90,
                        hotdog: 7.90,
                        nachos: 14.90,
                        agua: 3.90,
                        mym: 6.90,
                        canchita_dulce: 9.90,
                        red_bull: 9.90,
                    };
                    const price = priceMap[productId] || 0;
                    total += price * quantity;

                    if (quantity > 0) {
                        const productDiv = document.createElement('div');
                        productDiv.className = 'bg-white rounded-lg shadow-md p-6 flex justify-between items-center';
                    
                        productDiv.innerHTML = `
                            <div class="text-left">
                                <h3 class="text-xl font-bold">${productId.replace(/_/g, ' ')}</h3>
                                <p>Cantidad: <span id="${productId}-quantity">${quantity}</span></p>
                            </div>
                            <div class="text-right">
                                <p class="text-xl font-semibold text-gray-800">S/. ${price.toFixed(2)}</p> 
                            </div>
                        `;
                        
                        cartItemsContainer.appendChild(productDiv);
                    }
                });
                document.getElementById('total-price').textContent = `S/. ${total.toFixed(2)}`;
            } else {
                cartItemsContainer.innerHTML = '<p class="text-center">No hay productos en el carrito.</p>';
                document.getElementById('total-price').textContent = 'S/. 0.00';
            }
        }
    
        window.onload = loadCart;
    </script>
</div>

</html>